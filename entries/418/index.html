<html>
<head>
    <title>BLOG.IK.AM</title>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link href="https://fonts.googleapis.com/earlyaccess/sawarabimincho.css" rel="stylesheet"/>
    <style>
        body {
            font-size: small;
            font-family: "Sawarabi Mincho";
            margin: 20px;
        }

        a {
            color: darkslategray;
            text-decoration: none;
        }

        article {
            border: darkgrey solid 1px;
            border-radius: 10px;
            padding: 0 10px 10px;
        }

        footer {
            margin: 10px;
        }

        blockquote {
            color: #464646;
            font-style: italic;
            border: darkgrey dotted 1px;
            border-radius: 5px;
            margin: 5px 0;
            padding: 10px;
        }

        pre {
            background-color: dimgray;
            color: white;
            padding: 5px;
            border-radius: 5px;
        }

        h3:before {
            content: "â˜•ï¸ ";
        }

        h4:before {
            content: "ğŸƒ ";
        }

        h5:before {
            content: "âœˆï¸ï¸ ";
        }

        h6:before {
            content: "â˜ï¸ ";
        }

        pre {
            margin-bottom: 10px;
        }
    </style>
</head>
<h1>âœï¸ BLOG.IK.AM</h1>
<p><a href="https://twitter.com/making">@making</a>'s memo</p>
<body>
<article>
    <h2><a href="">ã¯ã˜ã‚ã¦ã®Spring WebFlux (ãã®1.5 - Spring Bootã‚’ä½¿ã‚ãšSpring WebFluxã‚’ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã§Bootstrap)</a></h2>
    <p>
        Updated at <span>2017-06-06T17:46:58Z</span> by <span>Toshiaki Maki</span><br>
        Created at <span>2017-05-09T19:15:17Z</span> by <span>Toshiaki Maki</span>
    </p>
    <div><p><a href="https://blog.ik.am/entries/417">ã¯ã˜ã‚ã¦ã®Spring WebFlux (ãã®1 - Spring WebFluxã‚’è©¦ã™)</a>ã§ã¯Spring Boot 2.0ã‚’ä½¿ç”¨ã—ã¦Spring WebFluxã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã—ãŸãŒã€ä»Šå›ã¯ç•ªå¤–ç·¨ã¨ã—ã¦Spring WebFluxã‚’ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã§Bootstrapã—ã¦ã¿ã¾ã™ã€‚
æ–¹æ³•ã¯<a href="http://docs.spring.io/spring/docs/5.0.0.RC1/spring-framework-reference/web.html#web-reactive-getting-started-manual">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚</p>
<p>ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹ã®@Controllerãƒ¢ãƒ‡ãƒ«ã§ã‚‚é–¢æ•°å‹ãƒ™ãƒ¼ã‚¹ã®Router Functionsãƒ¢ãƒ‡ãƒ«ã§ã‚‚<code>org.springframework.http.server.reactive.HttpHandler</code>ã«å¤‰æ›ã™ã‚‹ã¨ã“ã‚ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚
<code>HttpHandler</code>ã«å¤‰æ›ã—ãŸå¾Œã¯å„ç¨®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ã‚¢ãƒ€ãƒ—ã‚¿ã«æ¸¡ã—ã¦ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’å®Ÿè¡Œã™ã‚‹æµã‚Œã«ãªã‚Šã¾ã™ã€‚</p>
<p>æœ¬è¨˜äº‹ã§ã¯Router Functionsãƒ¢ãƒ‡ãƒ«ã§Reactor Nettyãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’ä½¿ã†æ–¹æ³•ã®ã¿ç´¹ä»‹ã—ã¾ã™ã€‚</p>
<p><strong>ç›®æ¬¡</strong></p>
<!-- toc -->
<ul>
<li><a href="#-">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</a></li>
<li><a href="#annotation-bean-">Annotationãƒ™ãƒ¼ã‚¹ã®Beanå®šç¾©</a></li>
<li><a href="#functional-bean-">FunctionalãªBeanå®šç¾©</a></li>
</ul>
<!-- tocstop -->
<h3 id="-">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</h3>
<p>Spring Bootã‚’ä½¿ã‚ãªã„ã¨è¨€ã„ã¾ã—ãŸãŒã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè‡ªä½“ã¯Spring Initializrã‹ã‚‰ä½œæˆã—ãŸæ–¹ãŒæ¥½ã§ã™ã€‚Spring Initializrã®é››å½¢ã‚¯ãƒ©ã‚¹ã‹ã‚‰ä¸è¦ãªã‚‚ã®ã‚’å‰Šé™¤ã—ã¦ã„ãã¾ã™ã€‚</p>
<p>æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<pre><code>curl https://start.spring.io/starter.tgz \
       -d bootVersion=2.0.0.BUILD-SNAPSHOT \
       -d artifactId=manual-webflux \
       -d baseDir=manual-webflux \
       -d dependencies=webflux \
       -d applicationName=ManualWebFluxApplication | tar -xzvf -
</code></pre><p>ã¾ãšã¯å‰è¨˜äº‹ã¨åŒã˜ãSpring Bootã§Router Functionsã®Hello Worldã‹ã‚‰å§‹ã‚ã¾ã™ã€‚</p>
<p><code>ManualWebFluxApplication.java</code>ã«æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚</p>
<pre><code class="lang-java">package com.example;

import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.ServerResponse;

@SpringBootApplication
public class ManualWebFluxApplication {

    public static void main(String[] args) {
        SpringApplication.run(ManualWebFluxApplication.class, args);
    }

    @Bean
    RouterFunction&lt;ServerResponse&gt; routes() {
        return route(GET(&quot;/&quot;), req -&gt; ok().syncBody(&quot;Hello World!&quot;));
    }
}
</code></pre>
<p>ã“ã®ã‚³ãƒ¼ãƒ‰ã®æ„å‘³ãŒã‚ã‹ã‚‰ãªã‘ã‚Œã°<a href="https://blog.ik.am/entries/417">ã¯ã˜ã‚ã¦ã®Spring WebFlux (ãã®1 - Spring WebFluxã‚’è©¦ã™)</a>ã‚’èª­ã¿ç›´ã—ã¦ãã ã•ã„ã€‚</p>
<p>æ¬¡ã«<code>RouterFunction&lt;ServerResponse&gt;</code>ã‚’<code>HttpHandler</code>ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯<code>RouterFunctions.toHttpHandler</code>ã‚’ä½¿ãˆã°ç°¡å˜ã§ã™ã€‚</p>
<p>ä¸€æ—¦ã€<code>ManualWebFluxApplication</code>ã‹ã‚‰Spring Booté–¢é€£ã®ã‚³ãƒ¼ãƒ‰ã‚’å‰Šã‚Šã€<code>HttpHandler</code>ã‚’ä½œã‚‹ã¨ã“ã‚ã¾ã§æ›¸ãã¾ã™ã€‚</p>
<pre><code class="lang-java">package com.example;

import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

import org.springframework.http.server.reactive.HttpHandler;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.reactive.function.server.ServerResponse;

public class ManualWebFluxApplication {

    public static void main(String[] args) {
        HttpHandler httpHandler = RouterFunctions.toHttpHandler(routes());
    }

    static RouterFunction&lt;ServerResponse&gt; routes() {
        return route(GET(&quot;/&quot;), req -&gt; ok().syncBody(&quot;Hello World!&quot;));
    }
}
</code></pre>
<p>ã“ã“ã¾ã§ã¯Spring WebFluxã®ä¸–ç•Œã§ã™ã€‚</p>
<p>æ¬¡ã¯Reactor Nettyã®ä¸–ç•Œã«ç§»ã‚Šã¾ã™ã€‚<code>HttpHandler</code>ã‹ã‚‰Reactor Nettyã®ãƒãƒ³ãƒ‰ãƒ©ã«å¤‰æ›ã—ã¦ã€Reactor Nettyã®Webã‚µãƒ¼ãƒãƒ¼æ©Ÿèƒ½ã‚’æ‹…ã†<code>HttpServer</code>ã«æ¸¡ã—ã¾ã™ã€‚
<code>HttpHandler</code>ã‹ã‚‰Reactor Nettyã®ãƒãƒ³ãƒ‰ãƒ©ã¸ã®å¤‰æ›ã¯<code>org.springframework.http.server.reactive.ReactorHttpHandlerAdapter</code>ã‚’åš™ã¾ã™ã®ã¿ã§ã™ã€‚</p>
<pre><code class="lang-java">package com.example;

import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

import org.springframework.http.server.reactive.HttpHandler;
import org.springframework.http.server.reactive.ReactorHttpHandlerAdapter;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.reactive.function.server.ServerResponse;

import reactor.core.publisher.Mono;
import reactor.ipc.netty.NettyContext;
import reactor.ipc.netty.http.server.HttpServer;

public class ManualWebFluxApplication {

    public static void main(String[] args) {
        HttpHandler httpHandler = RouterFunctions.toHttpHandler(routes());

        HttpServer httpServer = HttpServer.create(&quot;0.0.0.0&quot;, 8080);
        Mono&lt;? extends NettyContext&gt; handler = httpServer
                .newHandler(new ReactorHttpHandlerAdapter(httpHandler));
    }

    static RouterFunction&lt;ServerResponse&gt; routes() {
        return route(GET(&quot;/&quot;), req -&gt; ok().syncBody(&quot;Hello World!&quot;));
    }
}
</code></pre>
<p>æœ€å¾Œã«Webã‚µãƒ¼ãƒãƒ¼ã®å¾…æ©Ÿã¨çµ‚äº†å¾…ã¡åˆã‚ã›ã®ãŸã‚ã«Nettyã®ä¸–ç•Œã«å…¥ã‚Šã¾ã™ã€‚</p>
<pre><code class="lang-java">package com.example;

import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

import org.springframework.http.server.reactive.HttpHandler;
import org.springframework.http.server.reactive.ReactorHttpHandlerAdapter;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.reactive.function.server.ServerResponse;

import io.netty.channel.Channel;
import reactor.core.publisher.Mono;
import reactor.ipc.netty.NettyContext;
import reactor.ipc.netty.http.server.HttpServer;

public class ManualWebFluxApplication {

    public static void main(String[] args) throws Exception {
        HttpHandler httpHandler = RouterFunctions.toHttpHandler(routes());

        HttpServer httpServer = HttpServer.create(&quot;0.0.0.0&quot;, 8080);
        Mono&lt;? extends NettyContext&gt; handler = httpServer
                .newHandler(new ReactorHttpHandlerAdapter(httpHandler));

        Channel channel = handler.block().channel();
        Runtime.getRuntime().addShutdownHook(new Thread(() -&gt; {
            try {
                channel.eventLoop().shutdownGracefully().sync();
            }
            catch (InterruptedException ignore) {
            }
        }));
        channel.closeFuture().sync();
    }

    static RouterFunction&lt;ServerResponse&gt; routes() {
        return route(GET(&quot;/&quot;), req -&gt; ok().syncBody(&quot;Hello World!&quot;));
    }
}
</code></pre>
<p>å¾Œã¯<code>src/main/resource/application.properties</code>ã‚’å‰Šé™¤ã—ã¦ã€ãŠå¥½ã¿ã§<code>logback.xml</code>ã‚’ä½œã£ã¦ãã ã•ã„ã€‚</p>
<p>ã‚µãƒ³ãƒ—ãƒ«ã‚’è²¼ã£ã¦ãŠãã¾ã™ã€‚</p>
<pre><code class="lang-xml">&lt;configuration&gt;
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %5p --- [%15.15t] %-40.40logger{39} : %m%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;root level=&quot;INFO&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
    &lt;/root&gt;
    &lt;logger name=&quot;reactor.ipc.netty&quot; level=&quot;DEBUG&quot;/&gt;
&lt;/configuration&gt;
</code></pre>
<p>ã“ã‚Œã§<code>ManualWebFluxApplication</code>ã‚’å†èµ·å‹•ã—ã¦ã€<a href="http://localhost:8080">http://localhost:8080</a>ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚</p>
<p>æ¬¡ã®ã‚ˆã†ãªãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚</p>
<pre><code>2017-05-10 04:07:37.873 DEBUG --- [           main] r.i.n.r.DefaultLoopEpollDetector         : Default epoll support : false
2017-05-10 04:07:37.962 DEBUG --- [           main] r.i.n.channel.CloseableContextHandler    : Connecting new channel: AbstractBootstrap$PendingRegistrationPromise@61d6015a(incomplete)
2017-05-10 04:07:37.978 DEBUG --- [ctor-http-nio-1] r.ipc.netty.http.server.HttpServer       : [id: 0xa7ca25f3] REGISTERED
2017-05-10 04:07:37.980 DEBUG --- [ctor-http-nio-1] r.ipc.netty.http.server.HttpServer       : [id: 0xa7ca25f3] BIND: /0.0.0.0:8080
2017-05-10 04:07:38.036 DEBUG --- [ctor-http-nio-1] r.ipc.netty.http.server.HttpServer       : [id: 0xa7ca25f3, L:/0:0:0:0:0:0:0:0:8080] ACTIVE
2017-05-10 04:07:44.686 DEBUG --- [ctor-http-nio-1] r.ipc.netty.http.server.HttpServer       : [id: 0xa7ca25f3, L:/0:0:0:0:0:0:0:0:8080] READ: [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362]
2017-05-10 04:07:44.687 DEBUG --- [ctor-http-nio-1] r.ipc.netty.http.server.HttpServer       : [id: 0xa7ca25f3, L:/0:0:0:0:0:0:0:0:8080] READ COMPLETE
2017-05-10 04:07:44.727 DEBUG --- [ctor-http-nio-2] r.i.n.http.server.HttpServerOperations   : New http connection, requesting read
2017-05-10 04:07:44.729 DEBUG --- [ctor-http-nio-2] r.ipc.netty.channel.ContextHandler       : After pipeline DefaultChannelPipeline{(reactor.left.loggingHandler = io.netty.handler.logging.LoggingHandler), (ServerContextHandler#0 = reactor.ipc.netty.channel.ServerContextHandler), (reactor.left.httpDecoder = io.netty.handler.codec.http.HttpRequestDecoder), (reactor.left.httpEncoder = io.netty.handler.codec.http.HttpResponseEncoder), (reactor.left.httpServerHandler = reactor.ipc.netty.http.server.HttpServerHandler), (reactor.right.reactiveBridge = reactor.ipc.netty.channel.ChannelOperationsHandler)}
2017-05-10 04:07:44.729 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] REGISTERED
2017-05-10 04:07:44.729 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] ACTIVE
2017-05-10 04:07:44.740 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] READ: 78B
         +-------------------------------------------------+
         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |
+--------+-------------------------------------------------+----------------+
|00000000| 47 45 54 20 2f 20 48 54 54 50 2f 31 2e 31 0d 0a |GET / HTTP/1.1..|
|00000010| 48 6f 73 74 3a 20 6c 6f 63 61 6c 68 6f 73 74 3a |Host: localhost:|
|00000020| 38 30 38 30 0d 0a 55 73 65 72 2d 41 67 65 6e 74 |8080..User-Agent|
|00000030| 3a 20 63 75 72 6c 2f 37 2e 34 33 2e 30 0d 0a 41 |: curl/7.43.0..A|
|00000040| 63 63 65 70 74 3a 20 2a 2f 2a 0d 0a 0d 0a       |ccept: */*....  |
+--------+-------------------------------------------------+----------------+
2017-05-10 04:07:44.750 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] READ COMPLETE
2017-05-10 04:07:44.751 DEBUG --- [ctor-http-nio-2] r.ipc.netty.channel.ChannelOperations    : [HttpServer] [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] handler is being applied: org.springframework.http.server.reactive.ReactorHttpHandlerAdapter@14c85872
2017-05-10 04:07:44.802 DEBUG --- [ctor-http-nio-2] r.i.n.channel.ChannelOperationsHandler   : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] Writing object DefaultHttpResponse(decodeResult: success, version: HTTP/1.1)
HTTP/1.1 200 OK
transfer-encoding: chunked
Content-Type: text/plain;charset=UTF-8
2017-05-10 04:07:44.810 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] WRITE: 87B
         +-------------------------------------------------+
         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |
+--------+-------------------------------------------------+----------------+
|00000000| 48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d |HTTP/1.1 200 OK.|
|00000010| 0a 74 72 61 6e 73 66 65 72 2d 65 6e 63 6f 64 69 |.transfer-encodi|
|00000020| 6e 67 3a 20 63 68 75 6e 6b 65 64 0d 0a 43 6f 6e |ng: chunked..Con|
|00000030| 74 65 6e 74 2d 54 79 70 65 3a 20 74 65 78 74 2f |tent-Type: text/|
|00000040| 70 6c 61 69 6e 3b 63 68 61 72 73 65 74 3d 55 54 |plain;charset=UT|
|00000050| 46 2d 38 0d 0a 0d 0a                            |F-8....         |
+--------+-------------------------------------------------+----------------+
2017-05-10 04:07:44.811 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] FLUSH
2017-05-10 04:07:44.814 DEBUG --- [ctor-http-nio-2] r.i.n.channel.ChannelOperationsHandler   : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] Writing object { &quot;operator&quot; : &quot;Map&quot; }
2017-05-10 04:07:44.817 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] WRITE: 3B
         +-------------------------------------------------+
         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |
+--------+-------------------------------------------------+----------------+
|00000000| 63 0d 0a                                        |c..             |
+--------+-------------------------------------------------+----------------+
2017-05-10 04:07:44.818 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] WRITE: 12B
         +-------------------------------------------------+
         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |
+--------+-------------------------------------------------+----------------+
|00000000| 48 65 6c 6c 6f 20 57 6f 72 6c 64 21             |Hello World!    |
+--------+-------------------------------------------------+----------------+
2017-05-10 04:07:44.819 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] WRITE: 2B
         +-------------------------------------------------+
         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |
+--------+-------------------------------------------------+----------------+
|00000000| 0d 0a                                           |..              |
+--------+-------------------------------------------------+----------------+
2017-05-10 04:07:44.819 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] FLUSH
2017-05-10 04:07:44.821 DEBUG --- [ctor-http-nio-2] r.i.n.http.server.HttpServerOperations   : Last HTTP response frame
2017-05-10 04:07:44.822 DEBUG --- [ctor-http-nio-2] r.i.n.channel.ChannelOperationsHandler   : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] Writing object EmptyLastHttpContent
2017-05-10 04:07:44.822 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] WRITE: 5B
         +-------------------------------------------------+
         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |
+--------+-------------------------------------------------+----------------+
|00000000| 30 0d 0a 0d 0a                                  |0....           |
+--------+-------------------------------------------------+----------------+
2017-05-10 04:07:44.822 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] FLUSH
2017-05-10 04:07:44.824 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] USER_EVENT: [Handler Terminated]
2017-05-10 04:07:44.826 DEBUG --- [ctor-http-nio-2] r.i.n.channel.ChannelOperationsHandler   : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] Disposing context reactor.ipc.netty.channel.ServerContextHandler@5286385e
2017-05-10 04:07:44.826 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 - R:/0:0:0:0:0:0:0:1:60362] READ COMPLETE
2017-05-10 04:07:44.829 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 ! R:/0:0:0:0:0:0:0:1:60362] INACTIVE
2017-05-10 04:07:44.829 DEBUG --- [ctor-http-nio-2] r.ipc.netty.http.server.HttpServer       : [id: 0x8a9527a1, L:/0:0:0:0:0:0:0:1:8080 ! R:/0:0:0:0:0:0:0:1:60362] UNREGISTERED
</code></pre><p>å¾Œã¯<code>pom.xml</code>ã‚’æ•´ç†ã—ã¾ã—ã‚‡ã†ã€‚åŸºæœ¬çš„ã«ã¯æ¬¡ã®<code>&lt;dependency&gt;</code>ã ã‘ã§ã™ã¿ã¾ã™ã€‚</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;manual-webflux&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;

    &lt;name&gt;demo&lt;/name&gt;
    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.0.0.BUILD-SNAPSHOT&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webflux&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.projectreactor.ipc&lt;/groupId&gt;
            &lt;artifactId&gt;reactor-netty&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;name&gt;Spring Snapshots&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;name&gt;Spring Milestones&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;

    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;name&gt;Spring Snapshots&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;name&gt;Spring Milestones&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;


&lt;/project&gt;
</code></pre>
<p>ã“ã‚Œã§<code>ManualWebFluxApplication</code>ã‚’å†èµ·å‹•ã—ã€åŒã˜ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
<p>ã“ã‚Œã§æœ€å°é™ã®Spring WebFluxã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã—ãŸã€‚ã‹ãªã‚Šãƒ¡ãƒ¢ãƒªãƒ•ãƒƒãƒˆãƒ—ãƒªãƒ³ãƒˆã‚’å°ã•ãæŠ‘ãˆã‚‰ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>
<p>å‹˜ã®è‰¯ã„äººã¯æ°—ã¥ã„ãŸã¨æ€ã„ã¾ã™ãŒã€ã“ã“ã¾ã§Springã®DIã‚³ãƒ³ãƒ†ãƒŠã§ã‚ã‚‹<code>ApplicationContext</code>ã‚’ä½¿ã£ã¦ã„ã¾ã›ã‚“(!)ã€‚
Spring WebFlux + RouterFunctionsã®å ´åˆã¯DIã‚³ãƒ³ãƒ†ãƒŠãªã—ã§ã‚‚èµ·å‹•ã—ã¾ã™ã€‚</p>
<p>å‰è¨˜äº‹åŒæ§˜ã«DIã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ã£ã¦<code>RouterFunctions</code>ã‚’Beanå®šç¾©ã™ã‚‹æ–¹æ³•ã‚’æ¬¡ã«è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="annotation-bean-">Annotationãƒ™ãƒ¼ã‚¹ã®Beanå®šç¾©</h3>
<p><a href="https://blog.ik.am/entries/417">ã¯ã˜ã‚ã¦ã®Spring WebFlux (ãã®1 - Spring WebFluxã‚’è©¦ã™)</a>ã§ä½œæˆã—ãŸæ¬¡ã®<code>EchoHandler</code>ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚</p>
<pre><code class="lang-java">package com.example;

import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

import org.springframework.stereotype.Component;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.ServerRequest;
import org.springframework.web.reactive.function.server.ServerResponse;

import reactor.core.publisher.Flux;
import reactor.core.publisher.Mono;

@Component
public class HelloHandler {

    public RouterFunction&lt;ServerResponse&gt; routes() {
        return route(GET(&quot;/&quot;), this::hello);
    }

    Mono&lt;ServerResponse&gt; hello(ServerRequest req) {
        return ok().body(Flux.just(&quot;Hello&quot;, &quot;World!&quot;), String.class);
    }
}
</code></pre>
<p>ä»Šå›ã¯<code>ManualWebFluxApplication</code>ã‚¯ãƒ©ã‚¹ã‚’JavaConfigã‚¯ãƒ©ã‚¹ã¨ã—ã¦ä½¿ã„ã¾ã™ã€‚ãªã®ã§ã€<code>ManualWebFluxApplication</code>ã«<code>@Configuration</code>ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¾ã™ [1]ã€‚ã¾ãŸã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚­ãƒ£ãƒ³ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«<code>ManualWebFluxApplication</code>ã«<code>@ComponentScan</code>ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¾ã™ [2]ã€‚ã“ã‚Œã§ã€<code>com.example</code>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é…ä¸‹ãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚­ãƒ£ãƒ³å¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚</p>
<p>DIã‚³ãƒ³ãƒ†ãƒŠã§ã‚ã‚‹<code>ApplicationContext</code>ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯æ±ç”¨çš„ãª<code>GenericApplicationContext</code>ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ«ãƒ¼ãƒˆã¨ãªã‚‹JavaConfigã¯<code>AnnotationConfigApplicationContext</code>ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«æ¸¡ã›ã°è‰¯ã„ã§ã™ [3]ã€‚</p>
<p><code>ApplicationContext</code>ã‚’ä½¿ã†å ´åˆã¯ã€<code>HttpHandler</code>ã‚’<code>WebHttpHandlerBuilder</code>ã§ä½œæˆã§ãã¾ã™ [4]ã€‚ã“ã®å ´åˆã€Router Functionsã‚’ä½¿ã†ã«ã¯DIã‚³ãƒ³ãƒ†ãƒŠã«ã¯BeanåãŒ<code>webHandler</code>ã§ã‚ã‚‹<code>org.springframework.web.server.WebHandler</code>å‹ã®BeanãŒç™»éŒ²ã•ã‚Œã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<code>RouterFunction&lt;ServerResponse&gt;</code>ã‹ã‚‰<code>WebHandler</code>ã«å¤‰æ›ã™ã‚‹éš›ã«ã‚‚<code>RouterFunctions.toHttpHandler</code>ãŒä½¿ãˆã¾ã™ã€‚ã“ã‚Œã‚’<code>@Bean</code>ã®ã¤ã„ãŸãƒ¡ã‚½ãƒƒãƒ‰ã§å®šç¾©ã—ã¾ã™ [5]ã€‚</p>
<p>(å®Ÿã¯<code>RouterFunctions.toHttpHandler</code>ã¯<code>HttpHandler</code>å…¼<code>WebHandler</code>ã§ã‚ã‚‹<code>org.springframework.web.server.adapter.HttpWebHandlerAdapter</code>ã‚’è¿”ã—ã¾ã™)</p>
<pre><code class="lang-java">package com.example;

import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.GenericApplicationContext;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.server.reactive.HttpHandler;
import org.springframework.http.server.reactive.ReactorHttpHandlerAdapter;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.server.WebHandler;
import org.springframework.web.server.adapter.WebHttpHandlerBuilder;

import io.netty.channel.Channel;
import reactor.core.publisher.Mono;
import reactor.ipc.netty.NettyContext;
import reactor.ipc.netty.http.server.HttpServer;

@Configuration // [1]
@ComponentScan // [2]
public class ManualWebFluxApplication {

    public static void main(String[] args) throws Exception {

        // [3]
        GenericApplicationContext context = new AnnotationConfigApplicationContext(
                ManualWebFluxApplication.class);
        context.registerShutdownHook();

        // [4]
        HttpHandler httpHandler = WebHttpHandlerBuilder.applicationContext(context)
                .build();

        HttpServer httpServer = HttpServer.create(&quot;0.0.0.0&quot;, 8080);
        Mono&lt;? extends NettyContext&gt; handler = httpServer
                .newHandler(new ReactorHttpHandlerAdapter(httpHandler));

        Channel channel = handler.block().channel();
        Runtime.getRuntime().addShutdownHook(new Thread(() -&gt; {
            try {
                channel.eventLoop().shutdownGracefully().sync();
            }
            catch (InterruptedException ignore) {
                ignore.printStackTrace();
            }
        }));
        channel.closeFuture().sync();
    }

    // [5]
    @Bean
    WebHandler webHandler(HelloHandler helloHandler) {
        return RouterFunctions.toHttpHandler(helloHandler.routes());
    }
}
</code></pre>
<p>ã“ã‚Œã§<code>ManualWebFluxApplication</code>ã‚’å†èµ·å‹•ã—ã¦ã€<a href="http://localhost:8080">http://localhost:8080</a>ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚Œã°HelloWorld!ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚</p>
<p>ä»¥é™ã€<code>HelloHandler</code>ã®ä½œã‚Šæ–¹ã¯æ™®é€šã®Springã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨åŒã˜ã§ã™ã€‚</p>
<h3 id="functional-bean-">FunctionalãªBeanå®šç¾©</h3>
<p>ä»Šåº¦ã¯Spring 5ã§å°å…¥ã•ã‚ŒãŸFunctional Bean Registrationã‚’ä½¿ã„ã€ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸€åˆ‡ä½¿ã‚ãšã€Functionalãªæ–¹æ³•ã§Beanå®šç¾©ã—ã¾ã™ã€‚</p>
<p>ã¾ãšã¯<code>EchoController</code>ã‹ã‚‰<code>@Controller</code>ã‚’å¤–ã—ã¾ã™ã€‚</p>
<pre><code class="lang-java">package com.example;

import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.ServerRequest;
import org.springframework.web.reactive.function.server.ServerResponse;

import reactor.core.publisher.Flux;
import reactor.core.publisher.Mono;

public class HelloHandler {

    public RouterFunction&lt;ServerResponse&gt; routes() {
        return route(GET(&quot;/&quot;), this::hello);
    }

    Mono&lt;ServerResponse&gt; hello(ServerRequest req) {
        return ok().body(Flux.just(&quot;Hello&quot;, &quot;World!&quot;), String.class);
    }
}
</code></pre>
<p>æ¬¡ã«ã„ã‚ˆã„ã‚ˆFunctional Bean Registrationã‚’è¡Œã„ã¾ã™ã€‚<code>@Configuration</code>ã€<code>@ComponentScan</code>ã€<code>@Bean</code>ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚‚ã†å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚</p>
<p>Beanå®šç¾©ã¯<code>GenericApplicationContext#registerBean(Class&lt;T&gt;, Supplier&lt;T&gt;, org.springframework.beans.factory.config.BeanDefinitionCustomizer...)</code>ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œãˆã¾ã™ã€‚</p>
<p><code>HelloHandler</code>ã¨<code>WebHandler</code>ã‚’<code>register(Class&lt;T&gt;, Supplier&lt;T&gt;)</code>ã§å®šç¾©ã—ã¦ã€<code>GenericApplicationContext</code>ã‚’<code>refresh</code>ã™ã‚Œã°DIã‚³ãƒ³ãƒ†ãƒŠä½œæˆå®Œäº†ã§ã™ã€‚</p>
<pre><code class="lang-java">package com.example;

import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.GenericApplicationContext;
import org.springframework.http.server.reactive.HttpHandler;
import org.springframework.http.server.reactive.ReactorHttpHandlerAdapter;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.server.WebHandler;
import org.springframework.web.server.adapter.WebHttpHandlerBuilder;

import io.netty.channel.Channel;
import reactor.core.publisher.Mono;
import reactor.ipc.netty.NettyContext;
import reactor.ipc.netty.http.server.HttpServer;

public class ManualWebFluxApplication {

    public static void main(String[] args) throws Exception {

        GenericApplicationContext context = new AnnotationConfigApplicationContext();
        context.registerBean(HelloHandler.class, HelloHandler::new); // context.registerBean(HelloHandler.class)ã§ã‚‚OK
        context.registerBean(WebHandler.class, () -&gt; RouterFunctions
                .toHttpHandler(context.getBean(HelloHandler.class).routes()));
        context.refresh();

        context.registerShutdownHook();

        HttpHandler httpHandler = WebHttpHandlerBuilder.applicationContext(context)
                .build();

        HttpServer httpServer = HttpServer.create(&quot;0.0.0.0&quot;, 8080);
        Mono&lt;? extends NettyContext&gt; handler = httpServer
                .newHandler(new ReactorHttpHandlerAdapter(httpHandler));

        Channel channel = handler.block().channel();
        Runtime.getRuntime().addShutdownHook(new Thread(() -&gt; {
            try {
                channel.eventLoop().shutdownGracefully().sync();
            }
            catch (InterruptedException ignore) {
                ignore.printStackTrace();
            }
        }));
        channel.closeFuture().sync();
    }
}
</code></pre>
<p>ã“ã‚Œã§<code>ManualWebFluxApplication</code>ã‚’å†èµ·å‹•ã—ã¦ã€<a href="http://localhost:8080">http://localhost:8080</a>ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚Œã°HelloWorld!ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
Spring Bootã‚‚ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ã§Springã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ<img class="emoji" draggable="false" src="https://twemoji.maxcdn.com/16x16/1f64c.png"></p>
<hr>
<p>æœ¬è¨˜äº‹ã§ã¯Spring WebFluxã®ç•ªå¤–ç·¨ã¨ã—ã¦Spring Bootã‚’ä½¿ã‚ãªã„æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã—ãŸã€‚å¤šåˆ†æ•°åMBå‰å¾Œã®ãƒ’ãƒ¼ãƒ—ã§ã‚‚å‹•ä½œã™ã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>
<p>ã¨ã¯ã„ãˆæ™®æ®µã¯Spring Boot 2.0ã§WebFluxã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ›¸ãã“ã¨ã«ãªã‚‹ã§ã—ã‚‡ã†ãŒã€
éŠã³ã§ã‚‚ã€ä¸­èº«ã‚’çŸ¥ã‚‹ä¸Šã§ã‚‚ãƒãƒ‹ãƒ¥ã‚¢ãƒ«èµ·å‹•ã®æ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ãŠãã“ã¨ã¯ãŸã‚ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚</p>
<p>æ¬¡å›ã¯æœ¬ç·šã«æˆ»ã£ã¦ã€<code>WebClient</code>ã¨ãƒ†ã‚¹ãƒˆã‚µãƒãƒ¼ãƒˆã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</p>
</div>
</article>
<footer>
    <a href="https://blog.ik.am">BLOG.IK.AM</a> â€” &copy; 2010-2017 <a href="https://twitter.com/making">Toshiaki
    Maki</a>
</footer>
</body>
</html>